# Task Memory — SSOT によるタスク管理

**`Plans.md` をタスクの Single Source of Truth（SSOT）として使用し、セッション間のコンテキストを維持する。**

## Plans.md フォーマット

```markdown
# Plans

## Project: {プロジェクト名}

### Phase {N}: {フェーズ名} `cc:WIP`

#### {タスクグループ名}

- `cc:done` {完了したタスク}
- `cc:WIP` {作業中のタスク}
- `cc:TODO` {未着手のタスク}
- `cc:blocked` {ブロックされたタスク} — 理由: {ブロック理由}

### Phase {N+1}: {次のフェーズ名} `cc:TODO`

#### {タスクグループ名}

- `cc:TODO` {タスク}

---

## Decisions

- {YYYY-MM-DD}: {設計判断の内容}

## Notes

- {補足情報}
```

## 状態マーカー

| マーカー       | 意味                     | 使い方                           |
| -------------- | ------------------------ | -------------------------------- |
| `cc:TODO`      | 未着手                   | まだ手をつけていないタスク       |
| `cc:WIP`       | 作業中                   | 現在取り組んでいるタスク         |
| `cc:done`      | 完了                     | 完了したタスク                   |
| `cc:blocked`   | ブロック中               | 外部要因で進められないタスク     |

### マーカーのルール

- 各タスク行の先頭にマーカーを配置する: `- \`cc:WIP\` タスク名`
- フェーズ見出しにもマーカーを付与できる: `### Phase 1: 設計 \`cc:done\``
- `cc:blocked` には理由を添える: `- \`cc:blocked\` タスク名 — 理由: {理由}`
- タスクの状態が変わったら、マーカーを即座に更新する

## セッション開始時の動作

SessionStart hook が `.claude/Plans.md` を読み込み、以下をコンテキストに注入する:

1. **WIP タスクの一覧** — 前回セッションで中断した作業
2. **blocked タスクの一覧** — 対処が必要なブロッカー
3. **次の TODO タスク** — 優先度の高い未着手タスク

## 運用ルール

### タスク状態の更新

- タスクに着手したら `cc:TODO` → `cc:WIP` に変更
- タスクが完了したら `cc:WIP` → `cc:done` に変更
- ブロックが発生したら `cc:blocked` に変更し理由を記載
- ブロックが解消されたら `cc:TODO` または `cc:WIP` に戻す

### Plans.md の管理

- Plans.md はプロジェクトの `.claude/Plans.md` に配置する
- `/task-state` スキルで Plans.md の作成・更新ができる
- 手動編集も可能（フォーマットに従うこと）
- Plans.md は git にコミットしてチーム共有を推奨

### 設計判断の記録

大きな設計判断は `## Decisions` セクションに日付付きで記録する:

```markdown
## Decisions

- 2026-02-21: REST API ではなく GraphQL を採用（理由: フロントエンドの柔軟性）
- 2026-02-20: PostgreSQL を選定（理由: JSON サポートと拡張性）
```
